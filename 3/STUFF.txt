Duarte Calado   (IT Director)             IP: 194.210.61.134
Adelino Estoiro (Financial Director)      IP: 194.210.61.135
Miguel Pontes   (Gateway Security Intern) IP: 194.210.61.136 (quem nos deu a info da network topology da MEMEL)

#### T1 ####

Start time:
    Sep  5, 2025 09:05:06.000000000
End time:
    Sep  5, 2025 15:37:45.679933000
Duration:
    6 hours 32 minutes 39.68 seconds
Nº Packets:
    20465
Participants:
    Miguel Pontes - sent: 3101
                  - received: 7041
Searches:
    tcp.stream eq 0, on packet 21, chat:    09:05:17.023011000 -- 09:07:50.599027000
        discoveries/chat.freenode.net/t1-tcp_stream_0.txt
        (In the middle of this conversation miguel was on spotify, probably listening to the music Catarina sent, kinda irrelevant)
    
    tcp.stream eq 129, on packet 19669, chat:  11:27:32.276342000 -- 11:31:21.966070000
        discoveries/chat.freenode.net/t1-tcp_stream_129.txt
    
    tcp.stream eq 130, on packet 19994, chat:  15:27:30.991132000 -- 15:37:45.679933000
        discoveries/chat.freenode.net/t1-tcp_stream_130.txt


#### T2 ####

Start time:
    Sep  6, 2025 11:00:00.000000000
End time:
    Sep  6, 2025 11:22:02.550483000
Duration:
    22 minutes 2.55 seconds
Nº Packets:
    91929
Participants:
    Duarte Calado - sent: 1616
                  - received: 1677
    Miguel Pontes - sent: 17788
                  - received: 27703
Searches:
    control + f on packet details "arp-scan":
        tcp.stream eq 59, on packet 4505: 11:00:09.870869000 -- 11:03:02.232861000
            Miguel was on https://www.kali.org/tools/arp-scan/ -> sus

    arp:
        Starting on packet 8573: 11:00:52.303548000 -- 11:01:17.909148000
            Miguel ran an arp scan on the sub-network.

    http contains "reddit":
        tcp.stream eq 140, on packet 16604: 11:01:05.741578000 -- 11:01:12.955264000
            Miguel was on https://nmap.org/book/man-port-scanning-techniques.html -> sus
        tcp.stream eq 170, on packet 18156: 11:01:32.986114000 -- 11:04:27.966088000
            Miguel was on https://www.geeksforgeeks.org/ethical-hacking/port-scanning-techniques-by-using-nmap/ -> sus
    
    (tcp.flags.syn == 1 and tcp.flags.ack == 0 and ip.dst == 194.210.61.134) or (tcp.flags.reset == 1 and ip.dst == 194.210.61.136): 11:01:49.193466000 -- 11:01:49.262077000
        Starting on packet 30258, Miguel ran a port scann on Duarte, where he found FTP running in port 21 (FTP server responding with SYN/ACK).

    tcp.stream eq 1344, on packet 34316:    11:01:59.114330000 -- 11:07:51.432719000
        Miguel opened ChatGPT, where he sent 180 client packets and the server sent 4379 packets (120 turns), conversation lasted 5 minutes and 52 seconds.
        Conversation is in discoveries/chatgpt/t3-tls_stream.txt. To get ChatGPT responses run chatgpt_responses.py (it does it automatically).
    
    On packet 61103:    11:05:18.444098000
        Miguel searched "how to use medusa" in google
        tcp.stream eq 1414, on packet 62951:    11:05:26.967138000 -- 11:08:18.905266000
            Miguel was on https://www.kali.org/tools/medusa/
    
    tcp.stream eq 1415, starting on packet 63285:   11:05:51.912961000 -- 11:05:52.872469000
        Duarte downloaded: http://archive.ubuntu.com/ubuntu/pool/main/p/poppler/poppler-utils_24.02.0-1ubuntu9.7_amd64.deb -> useless?
   
    ip.dst == 194.210.61.134 and ip.src == 194.210.61.136 and ftp:
        Starting on packet 64468:   11:06:20.140121000 -- 11:08:48.243240000
            1.	Miguel connects to FTP service (port 21) on Duarte's machine.
            2.	Logs in as duarte, after 13 failed attemps, he uses the correct the password: "duartinhothebest".
            3.	Browses directories.
            4.	Downloads files (parking.db -> packet 65042 -- 11:08:01.218709000, adelino.eml -> packet 65339 -- 11:08:32.576461000, Smart Algorithm email -> packet 65359 -- 11:08:37.148326000).
            (files on discoveries/duarte)

    After, Miguel searched in google for parking in lisbon and for futuro inteligente:
        tcp.stream eq 1468, on packet 67741:  11:10:40.788799000 -- 11:11:46.522273000    
            https://belocal.pt/en/parking-in-lisbon/
        tcp.stream eq 1530, on packet 80005:    11:11:09.565378000 -- 11:14:10.283542000
            https://en.wikipedia.org/wiki/Smart_city
        tcp.stream eq 1555, on packet 81404:   11:11:25.688161000 -- 11:12:01.073145000
            https://lisboaaberta.cm-lisboa.pt/index.php/pt/lisboa-inteligente
        tcp.stream eq 1576, on packet 85873:    11:12:01.756885000 -- 11:12:08.524841000
            https://futurointeligente.pt
    
    tcp.stream eq 1620, on packet 91054, chat: 11:14:57.428117000
        discoveries/chat.freenode.net/t2-tcp_stream_1620.txt


#### T3 ####

Start time:
    Sep  6, 2025 15:12:00.000000000
End time:
    Sep  6, 2025 15:44:54.320178000
Duration:
    32 minutes 54.32 seconds
Nº Packets:
    97334
Participants:
    Adelino Estoiro - sent: 9799
                    - received: 14397
    Miguel Pontes   - sent: 11783
                    - received: 15792

Searches:
    http contains "reddit":
        Adelino Estoiro:
            https://appleid.cdn-apple.com/appleauth/static/jsapi/appleid/1/en_US/appleid.auth.js -> logged in with apple id, useless
    
    tcp.stream eq 16, on packet 178, chat:   15:12:20.947620000 -- 15:17:12.562016000
        discoveries/chat.freenode.net/t3-tcp_stream_16.txt
    
    arp:
        Starting on packet 679: 15:17:30.222092000 -- 15:17:43.848634000
            Miguel Ran an arp scan on the sub-network.
    
    (tcp.flags.syn == 1 and tcp.flags.ack == 0 and ip.dst == 194.210.61.135) or (tcp.flags.reset == 1 and ip.dst == 194.210.61.136):    15:17:44.192876000 -- 15:17:44.289871000
        Starting on packet 2812, Miguel ran a port scann on Adelino, where he found ssh running in port 22.
    
    On packet 5025: 15:17:49.565305000
        Miguel searched "How to establish a connection ussing ssh port" in google.
    
    tcp.stream eq 1058, on packet 7018: 15:17:54.233740000 -- 15:20:46.793435000
        Miguel was on https://askubuntu.com/questions/264046/how-to-run-the-ssh-server-on-a-port-other-than-22 -> sus
    
    tcp.stream eq 1160, on packet 12523:    15:18:09.231512000 -- 15:21:19.633026000
        Miguel was on https://www.digitalocean.com/community/tutorials/how-to-use-ssh-to-connect-to-a-remote-server -> sus
    
    tcp.stream eq 1268, on packet 20241:    15:18:32.759705000 -- 15:20:34.702153000
        Miguel was on https://opensource.com/article/20/9/ssh -> sus
    
    ssh, starting on packet 23560:  15:18:56.603470000 -- 15:18:56.736579000
        Miguel tested a ssh connection to Adelino's computer on port 22.
    
    On packet 23666:    15:19:02.279544000
        Miguel searched for "phishing" in google.
        tcp.stream eq 1348, on packet 27160:    15:19:13.014830000 -- 15:20:26.312635000
            Miguel was on https://www.malwarebytes.com/pt/phishing -> sus
    
    tcp.stream eq 1447, on packet 32848:    15:19:37.252611000 -- 15:23:53.247383000
        Miguel opened ChatGPT, where he sent 106 client mesages and the server sent 138 messages (62 turns), conversation lasted 4 minutes and 16 seconds.
        Conversation is in discoveries/chatgpt/t2-tls_stream.txt. To get ChatGPT response run chatgpt_responses.py (it does it automatically).
    
    http2.headers.path contains "search":
        On packet 47541, Adelino searched for "what to do with excess money" in google:   15:22:02.549538000
            tcp.stream eq 1555, on packet 52748:    15:22:06.625604000 -- 15:26:18.880305000
                Adelino was on https://www.reddit.com/r/FinancialPlanning/comments/umjp5b/what_to_do_with_extra_money/
        On packet 60407, Adelino searched for "gambling" in google:     15:22:41.159340000
    
    tcp.port == 1337, starting on packet 95057, backdoor:  15:31:57.625196000 -- 15:35:16.661144000
        tcp.stream eq 2025, where backdoor activity starts:
            On packet 95057:
                In port 1337 Adelino (client) establishes a connection to Miguel (server, Python-based HTTP server)
            This connections is estabelished a couple of times and then using:
                tcp.port == 1337 && http.request.method == "POST":
                    We can see that:
                        file 1 sent on packet 95556 -- 15:33:19.144456000
                        file 2 sent on packet 95913 -- 15:34:50.481205000
                        files are encrypted, use decryp_pdfs.py to decrypt them and get the 2 hidden pdfs from lab1
                        (files on discoveries/pdfs)
    
    tcp.stream eq 2054, on packet 96095,chat: 15:35:55.003850000 -- 15:44:54.320331000
        discoveries/chat.freenode.net/t3-tcp_stream_2054.txt


#### Searches in all files ####

ip.src == chat.freenode.net or ip.dst == chat.freenode.net:
        - Retrieved multiple conversation between Miguel Pontes in file discoveries/chat.freenode.net/, they found out something was up, they were likely the ones who found the hidden files we recovered in lab 1
        - Miguel likes Catarina, given: (and also other stuff, just read the entire conversation)
            PRIVMSG: Ahahahaha yap! I don't want my heart racing all the time ahahahah you already do this to me all the time I don't need more XD
            CatDucky: Tf are u talking about? o.o
            PRIVMSG: Nothing :)
        - They saying they gonna send Joao the files cuz his dad his running for mayor and the current mayor's wife is the boss of Futuro Inteligente LDA.
(ip.src == chat.freenode.net || ip.dst == chat.freenode.net) && (tcp.flags.fin == 1 && tcp.flags.ack == 1) -> to confirm we got every message

#### Random shit ####

Found proof of 6/6 hidden files:
    1. The diff file                       -> found by Catarina (t1 -> tcp.stream eq 130, starting on packet 20201, ending on packet 20263, Sep 5, 2025 15:29:32.993345000 -- Sep 5, 2025 15:30:04.548936000)
    2. https://files.catbox.moe/nyinuq.png -> found by Miguel   (t1 -> packet 20390, Sep 5, 2025 15:35:34.841764000)
    3. Snippets of the DataBase            -> found by Miguel   (t2 -> packet 65042, Sep 6, 2025 11:08:01.218709000)
    4. https://files.catbox.moe/jygyt1.png -> taken by Miguel   (t3 -> packet 491  , Sep 6, 2025 15:14:15.553890000)
    5. MEMEL's financial report            -> found by Miguel   (t3 -> packet 95556, Sep 6, 2025 15:33:19.144456000)
    6. Invoice tied Futuro Inteligente LDA -> found by Miguel   (t3 -> packet 95913, Sep 6, 2025 15:34:50.481205000)

What happened:
Miguel and Catarina found the 6 files, those tie to the mayor, they gonna send them to the mayor rival, they send from anonymous email.
Catarina was lying when she said she didn't now nothing about that.
She said she received an email to retrieve a usb drive? But wasnt the info going in the email? Something happened. Maybe she received the email and put the content in the usb drive and then gave it to Joao.